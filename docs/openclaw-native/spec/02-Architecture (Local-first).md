# DzzenOS (OpenClaw Native) — Architecture (local‑first)

## 0) Принцип
**OpenClaw = runtime и оркестратор**, DzzenOS = продуктовый слой (UX + данные + политика) поверх него.

Мы уходим от модели “наши воркеры исполняют runs” к модели:
- исполнение runs локально
- данные (boards/docs) локально
- облако опционально (sync/marketplace), но не требуется для работы

---

## 1) Компоненты

### 1.1 DzzenOS Skill (пакет для OpenClaw)
Содержит:
- локальный сервис (Node.js) с API для UI
- хранилище данных
- реализацию domain-логики (boards/tasks/docs/runs/artifacts/approvals)
- MCP tools для управления DzzenOS из любого агента (внутри OpenClaw)

### 1.2 Хранилище (локально)
MVP:
- SQLite (один файл в state dir OpenClaw)

Позже:
- опционально Postgres (для power users)

### 1.3 UI (локально)
Варианты:
- локальный веб‑интерфейс (Next.js/Vite) на `localhost` + ссылка из OpenClaw dashboard
- либо интеграция как “страница” в OpenClaw UI (если есть плагин‑точки)

### 1.4 Исполнение агентных runs
Run выполняется средствами OpenClaw:
- модели: любые доступные (локальные/облачные)
- tools: системные + skills
- sandbox: по стандартам OpenClaw

DzzenOS лишь:
- формирует **контекст‑пакет** (docs + brief + политика)
- запускает выполнение
- сохраняет прогресс/артефакты

---

## 2) Данные и границы ответственности

### 2.1 DzzenOS отвечает за
- структуру работы (workspaces/boards/tasks)
- хранение docs/memory
- правила и безопасность (approvals, ограничения)
- историю run’ов и артефактов

### 2.2 OpenClaw отвечает за
- реальные вызовы моделей
- исполнение tool calls
- менеджмент сессий/контекста агента

---

## 3) Модель безопасности

### 3.1 Принцип “опасные действия требуют апрува”
Если агент собирается:
- отправить письмо
- опубликовать пост
- удалить/перезаписать критичный документ
- потратить budget выше лимита

…то DzzenOS создаёт approval, и агент ждёт подтверждения.

### 3.2 Политика tools
В board_agent_settings задаётся:
- allowlist/denylist skills/tools
- запрет сетевых вызовов (если нужно)
- запрет записи в файловую систему

---

## 4) Как укладывается Directus
В нативной модели Directus становится:
- НЕ обязательным
- возможным “админским режимом” для редактирования коллекций/данных

Но для MVP лучше убрать Directus, чтобы установка была простой.

---

## 5) Переходный период
Мы можем оставить текущий Postgres/Directus‑дизайн как:
- спецификацию данных
- “профессиональный режим” для hosted/enterprise

А нативный MVP строить на SQLite с теми же сущностями.
